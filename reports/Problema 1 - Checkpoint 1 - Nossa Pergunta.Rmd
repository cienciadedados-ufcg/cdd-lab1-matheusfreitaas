---
title: "Problema 1 - Checkpoint 1 - Nossa Pergunta"
author: "Matheus Freitas"
date: "23 de abril de 2018"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
  html_notebook:
    toc: yes
    toc_float: yes
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(here)
library(raster)
theme_set(theme_bw())
```

Analisaremos os episódios da primeira até a quarta temporada das séries Vikings e Game of Thrones.
```{r}
data = read_csv(here("data/series_from_imdb.csv"), 
                    progress = FALSE,
                    col_types = cols(.default = col_double(), 
                                     series_name = col_character(), 
                                     episode = col_character(), 
                                     url = col_character(),
                                     season = col_character())) %>% 
    filter(series_name %in% c("Vikings", "Game of Thrones")) %>%
    filter(season %in% 1:4)

```


Aqui percebemos a diferença na quantidade de usuários que votaram em cada uma das séries a cada temporada. Fica claro que uma das séries possui mais expectadores que utilizam o IMDB, dessa forma as análises a seguir vão buscar levar isso em conta.
```{r}
data %>% 
    ggplot(mapping = aes(x = season_ep, 
               y = user_votes,
               color = series_name))  + 
    geom_line() + 
    geom_point() +
    facet_wrap(~ season) +
    labs(x = "Episodios", 
         y = "Quantidade de votos", 
         color = "Séries")
```

Nos gráficos abaixo podemos verificar qual das séries é mais bem avaliada a cada temporada.
Assim ao observarmos que "Game of Thrones" possui quase que sua totalidade de pontos acima dos pontos da série "Vikings", ou seja, os episódios da primeira são mais bem avaliados do que os episódios da segunda, respectivamente. 
```{r}
data %>%
  ggplot(mapping = aes(x = season_ep, 
                       y = user_rating, 
                       color = series_name)) +
  geom_line() +
  geom_point() +
  facet_wrap(~season) +
  labs(x = "Episódio",
       y = "Nota do Episódio",
       color = "Séries" )
```
Ao compararmos os gráficos acima, podemos notar que embora tenha uma quantidade quase que igual de votos em cada um dos episódios, a série "Vikings", possui uma discrepância relativamente grande nas notas dos seus episódios. Contudo, "Game of Thrones" possui notas mais estáveis, os pontos que se destacam por serem muito diferentes dos demais podem ser justificados pelo aumento da quantidade de votos nesses mesmos episódios.
Contudo, essa não é uma análise precisa.Tentaremos chegar a um resultado mais correto abaixo:

```{r}
vikingsUserRating = filter(data, series_name == "Vikings")$user_rating
gotUserRating = filter(data, series_name == "Game of Thrones")$user_rating

data %>%
  summarise(desvioPadrao_vikings = sd(vikingsUserRating),
            desvioPadrao_got = sd(gotUserRating))
```
Analisando esses desvios padrões relativos aos votos dos usuários para cada uma das séries, podemos chegar a conclusão que, devido ao desvio da série "Game of Thrones" ser maior, as notas dos seus episódios são as que mais variam.